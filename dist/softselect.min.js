!function(){"use strict";angular.module("softselect.directive",[]).directive("softselect",function(s){return{restrict:"E",replace:!0,scope:{ssData:"=",ssModel:"=",ssField:"=",ssMany:"<?",ssChange:"=",ssTabindex:"=tabindex",ssDisabled:"=?bind"},templateUrl:"softselect.html",compile:function(e,l){return{pre:function(e,l,n){function a(){angular.equals(e.ssModel,void 0)||angular.equals(e.ssModel,[])||angular.equals(e.ssModel,{})?(angular.forEach(e.ssData,function(s){s.selected&&!localStorage.getItem("limparFiltro")||(s.selected=!1)}),e.displayPlaceHolder=!0):e.displayPlaceHolder=!1}function t(){if(a(),angular.isArray(e.ssModel,[]))angular.forEach(e.ssModel,function(s){if(!angular.equals(e.ssData,void 0)){var l=e.ssData.findIndex(function(l){return l[e.ssField.value]===s[e.ssField.value]});e.ssData[l].selected=!0}}),e.ssChange&&e.ssChange(void 0);else if(e.ssModel){if(!angular.equals(e.ssData,void 0)){var s=e.ssData.findIndex(function(s){return s[e.ssField.value]===e.ssModel[e.ssField.value]});angular.equals(e.ssData[s],void 0)||(e.ssData[s].selected=!0),e.ssChange&&e.ssChange(e.ssData[s])}}else e.ssModel={},e.ssChange&&e.ssChange(void 0)}function o(){var l=e.ssData;return e.ssFilter&&(l=s("filter")(l,e.ssFilter)),l=s("limitTo")(l,e.selectLimit),l=s("orderBy")(l,e.ssField.orderby)}function i(){angular.forEach(e.ssData,function(s){s.selected=!1}),e.ssModel=[],e.displayPlaceHolder=!0}var d=0;e.ssDisabled=!1,e.ssFilter="",e.selectLimit=10,e.ssMany=e.$eval(n.ssMany)||!1,e.getFilteredData=o,e.ss_select=function(s){if(e.displayPlaceHolder=!1,e.ssMany){e.ssModel||(e.ssModel=[]);var l=e.ssModel.some(function(e){return s===e});s.selected&&(l=s.selected),l?(e.ssModel=e.ssModel.filter(function(e){return e.id!==s.id}),s.selected=!1):(s.selected=!0,e.ssModel.push(s))}else i(),s.selected=!0,e.ssModel=angular.copy(s);e.ssChange&&e.ssChange(s),a(),e.ssFilter="",o()},e.ss_selectAll=function(){e.displayPlaceHolder=!1,angular.forEach(e.ssData,function(s){s.selected=!0}),e.ssModel=e.ssData},e.ss_clearAll=i,a(),$(".softselect .dropdown").on("click",function(){var s=$(this),e=$(this).find(".dropdown-menu");e.css("top",s.offset().top+s.height()-$(window).scrollTop()),e.css("left",s.offset().left),e.css("min-width",s.width()),e.toggleClass("open"),s.toggleClass("btn-open")}),$(window).scroll(function(){var s=$(".softselect .btn-open");if(s.length>0){var e=$(".softselect .btn-open .open"),l=$(this).scrollTop();e.css("top",s.offset().top+s.height()-l)}}),$(".softselect .dropdown .dropdown-menu").scroll(function(){var s=$(this).scrollTop(),l=$(this).prop("scrollHeight")-$(this).outerHeight();l!=d&&s>=l&&e.selectLimit<e.ssData.length&&(e.$apply(function(){e.selectLimit=e.selectLimit+10}),l!=d&&(l=d))}),e.$watch("ssModel",function(){t()}),e.$watch("ssData",function(){t()})},post:function(s,e,l){}}}}})}(),angular.module("softselect.directive").run(["$templateCache",function(s){s.put("softselect.html",'\n<div class="softselect" ng-class="{\'disabled\':ssDisabled}">\n\n    <div class="dropdown ">\n\n\n            <div tabindex="{{ssTabindex}}"  class="selected-box" placeholder="" aria-describedby="basic-addon2" data-toggle="dropdown" >\n\n                <div class="full-h" ng-if="!ssMany">\n\n                    <div class="form-group has-feedback">\n\n                        <input class="form-control" ng-model="ssModel[ssField.text]" placeholder="{{ssField.placeholder ? ssField.placeholder : \'Selecionar...\'}}">\n\n                        <span class="fa fa-caret-down form-control-feedback" aria-hidden="true"></span>\n\n                    </div>\n\n                </div>\n\n                <div class="full-h" ng-if="ssMany">\n\n                    <div class="form-group has-feedback">\n\n                        <div class="form-control">\n\n                        <label ng-if="displayPlaceHolder" class="selected-placeholder">{{ssField.placeholder ? ssField.placeholder : \'Selecionar...\'}}</label>\n\n                        <label ng-if="ssModel.length > 2" class="selected-count">\n\n                            {{ssModel.length === ssData.length ? "Todos" : ssModel.length}} selecionados\n\n                        </label>\n\n                        <ul ng-if="(!displayPlaceHolder && ssModel.length > 0 && ssModel.length <= 2)">\n\n                            <li ng-repeat="item in ssModel track by $index">\n\n                                {{item[ssField.text]}}\n\n                            </li>                    &nbsp;\n\n                        </ul>\n\n                    </div>\n\n                        <span class="fa fa-caret-down form-control-feedback" aria-hidden="true"></span>\n\n                    </div>\n\n                </div>\n\n            </div>\n\n            <div class="dropdown-menu dropdown-menu-left scroll-4">\n\n                <div class="controls">\n\n                    <input ng-show="ssData.length > 10" class="form-control softselect-filter" ng-model="ssFilter" placeholder="Procurar...">\n\n                    <span ng-click="ss_selectAll()" ng-if="::ssMany">Selecionar todos</span> | <span ng-click="ss_clearAll()">Limpar</span>\n\n                </div>\n\n                <hr style="margin:3px;">\n\n                <ul>\n\n                    <li class="item" ng-repeat="item in getFilteredData() | filter: ssModel[ssField.text]" ng-click="ss_select(item)">\n\n                        <i class="fa fa-check" ng-if="item.selected" style="color: #2ecc71" ></i> {{item[ssField.text]}}\n\n                    </li>\n\n                </ul>\n\n            </div>\n\n    </div>\n\n</div>\n')}]);